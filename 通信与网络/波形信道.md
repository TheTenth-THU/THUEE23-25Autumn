## 波形传输

电平是一个物理量，但不能脱离物理实体存在。在通信系统中，**电平**通常通过**波形**来传输，因此需要将[[电平信道]]延伸到**波形信道**。

### 波形映射

将离散的电平映射到连续的波形上的过程称为**波形映射**。常见的波形映射方式有：
+ **脉冲振幅调制（PAM）**：将不同的电平映射为不同幅度的脉冲信号。
+ **频移键控（FSK）**：将不同的电平映射为不同频率的正弦波。
+ **相移键控（PSK）**：将不同的电平映射为不同相位的正弦波。
+ **正交振幅调制（QAM）**：结合幅度和相位的变化来表示不同的电平。
+ **正交频分复用（OFDM）**：将数据分散到多个正交的子载波上进行传输。

本课程专注于**线性调制 (linear modulation)**，即通过线性调幅一个**成形脉冲 (shaping pulse)** $p(t)$ 来实现波形映射。传输电平为 $x$ 的符号时，对应的波形为
$$
x(t) = x p(t)
$$
其中，$p(t)$ 是**归一化**的成形脉冲，满足
$$
\int_{-\infty}^{+\infty} p^{2}(t) \dif t = 1
$$
这样，传输一个符号的能耗即为
$$
E_{s} = \mathbb{E} \left[ \int_{-\infty}^{+\infty} x^{2}(t) \dif t \right]  = \mathbb{E} \left[ x^{2} \right] \dint_{-\infty}^{+\infty} p^{2}(t) \dif t = \mathbb{E} \left[ x^{2} \right] = \sigma^{2}_{x}
$$

### 波形信道模型

本课程重点关注**加性白 Gauss 噪声**对数字通信的影响，因此引入如下波形信道模型：

> [!def.] 加性白 Gauss 噪声波形信道
> 波形信道的输入为波形 $x(t)$，输出为波形 $y(t)$，满足
> $$
> y(t) = x(t) + z(t)
> $$
> 其中，$z(t)$ 是**白 Gauss 噪声 (white Gaussian noise)**，满足
> 1. 对任意时刻 $t$，$z(t)$ 服从均值为 0 的 Gauss 分布；
> 2. 对任意时刻序列 $t_{1}, t_{2}, \cdots, t_{n}$，随机变量组 $\{ z(t_{1}), z(t_{2}), \cdots, z(t_{n}) \}$ 服从均值为 $\v{0}$ 的 $n$ 元 Gauss 分布；
> 3. 功率谱密度函数 $S_{z}(f) \equiv \cfrac{n_{0}}{2}$，其中 $n_{0}$ 为常数。

## 二元波形的最佳接收

### 简单二元波形的最佳接收

考虑最简单的二元波形传输系统，传输的波形形式为
$$
x(t) = \begin{cases}
V, & t \in [0, T], & \text{传输「1」},  \\
-V, & t \in [0, T], & \text{传输「0」}
\end{cases}
$$
即取成形脉冲为矩形脉冲
$$
p(t) = \dfrac{1}{\sqrt{ T }}, \qquad t \in [0, T]
$$

#### 直接抽样的接收

尝试**直接抽样**接收波形 $y(t)$，注意到
$$
\mathbb{E} \left[ z^{2}(t_{i}) \right] = R_{z}(t_{i} - t_{i}) = \dfrac{n_{0}}{2} \delta(0) = +\infty
$$
因此，直接抽样接收的噪声功率为无穷大，显然不可行。

#### 区段积分的接收

观察 $p(t)$ 与 $z(t)$ 的波形特征，考虑通过**区段积分**的方式处理波形 $y(t)$，即计算
$$
y = \dint_{0}^{T} y(t) \dif t = \underbrace{ \dint_{0}^{T} x(t) \dif t }_{ x } + \underbrace{ \dint_{0}^{T} z(t) \dif t }_{ z \sim \mathcal{N}\left( 0, \tfrac{n_{0}T}{2} \right) }
$$
得到一个**等效电平信道**，其输入为**原来的符号电平 $x \in \left\{ VT, -VT \right\}$**，输出为等效输出电平 $y$，满足
$$
y = x + z
$$
其中，$z$ 服从均值为 0、方差为 $\cfrac{n_{0} T}{2}$ 的 Gauss 分布。这个电平信道的**信噪比**为
$$
\mathrm{SNR} = \dfrac{\sigma^{2}_{x}}{\sigma^{2}} = \dfrac{V^{2}T^{2}}{n_{0} T / 2} = \dfrac{V^{2} T}{n_{0} / 2}
$$

### 标准等价电平信道

对于上面[[#简单二元波形的最佳接收]]问题，我们希望能获得一个**最易于处理的等效电平信道**，于是考虑将噪声的方差固定为 $\cfrac{n_{0}}{2}$，这要求处理时
$$
y = \dfrac{1}{\sqrt{ T }} \dint_{0}^{T} y(t) \dif t = \dint_{0}^{T} y(t) \cdot \dfrac{1}{\sqrt{ T }} \dif t
= \dint_{0}^{T} y(t) \cdot p(t) \dif t 
$$
此时等效电平输入为 $x \in \left\{ V\sqrt{ T }, -V\sqrt{ T } \right\}$。

事实上，对于任意**能量归一化**成形脉冲 $p(t)$，都可以通过如下方式获得一个**标准等价电平信道**：
$$
y = \dint_{-\infty}^{+\infty} y(t) \cdot p(t) \dif t = \dint_{-\infty}^{+\infty} \left[ x(t) + z(t) \right] \cdot p(t) \dif t = x + z
$$
其中，$x = \dint_{-\infty}^{+\infty} x(t) \cdot p(t) \dif t$，$z = \dint_{-\infty}^{+\infty} z(t) \cdot p(t) \dif t \sim \mathcal{N}\left( 0, \cfrac{n_{0}}{2} \right)$。

由于 $p(t)$ 是归一化的，因此**等效电平信道的输入 $x$** 与**最初[[#波形映射]]时的符号电平 $x$** 相同，即信噪比为
$$
\mathrm{SNR} = \dfrac{\sigma^{2}_{x}}{\sigma^{2}} = \dfrac{E_{\mathrm{s}}}{n_{0} / 2}
$$

考虑使用任意能量归一化的 $g(t)$ 做类似的线性处理
$$
\hat{y} = \dint_{-\infty}^{+\infty} y(t) \cdot g(t) \dif t = \dint_{-\infty}^{+\infty} x(t) \cdot g(t) \dif t + \dint_{-\infty}^{+\infty} z(t) \cdot g(t) \dif t = \hat{x} + \hat{z}
$$
其中，仍有 $\hat{z} \sim \mathcal{N}\left( 0, \cfrac{n_{0}}{2} \right)$。由 **Cauchy-Schwarz 不等式**，这一处理的信噪比为
$$
\begin{align}
\widehat{\mathrm{SNR}} &= \dfrac{ \sigma^{2}_{\hat{x}} }{ \sigma^{2}_{\hat{z}} } = \dfrac{ \mathbb{E} \left[ \left( \dint_{-\infty}^{+\infty} x(t) \cdot g(t) \dif t \right)^{2} \right] }{ n_{0} / 2 } = \dfrac{\mathbb{E} \left[ x^{2} \right] \left( \dint_{-\infty}^{\infty} p(t)g(t) \dif t \right)^{2}}{n_{0} /2} \\
&= \dfrac{E_{\mathrm{s}}}{n_{0} / 2} \cdot \left( \dint_{-\infty}^{+\infty} p(t) g(t) \dif t \right)^{2}  \\
&\leq \dfrac{E_{\mathrm{s}}}{n_{0} / 2} \cdot \left( \dint_{-\infty}^{+\infty} p^{2}(t) \dif t \right) \left( \dint_{-\infty}^{+\infty} g^{2}(t) \dif t \right) = \dfrac{E_{\mathrm{s}}}{n_{0} / 2}
\end{align}
$$
因此，使用成形脉冲 $p(t)$ 进行线性处理可以获得最大的信噪比。

> [!thm.] 二进制波形传输的最佳接收
> 对于一般的二进制传输波形 $x(t) = xp(t)$（其中 **$x \in \{ -\sqrt{E_{\mathrm{s}}}, \sqrt{E_{\mathrm{s}}} \}$**，成形脉冲 $p(t)$ 满足**能量归一化**条件），在 AWGN 波形信道 $y(t) = x(t) + z(t)$ 上传输，其**最佳接收**处理为
> $$
> y = \dint_{-\infty}^{+\infty} y(t) \cdot p(t) \dif t = x + z
> $$
> 其中 $z \sim \mathcal{N}\left( 0, \cfrac{n_{0}}{2} \right)$，该等效电平信道的**信噪比**为 $\mathrm{SNR} = \cfrac{E_{\mathrm{s}}}{n_{0} / 2}$。
> 
> 对于任给的 $g(t)$，线性处理 $\hat{y} = \dint_{-\infty}^{+\infty} x(t) g(t) \dif t$ 的信噪比不超过 $\cfrac{E_{\mathrm{s}}}{n_{0}/2}$。
^ErjinzhiBoxinZuijiaJieshou

## 多进制波形的最佳接收

### 多进制标准等价电平信道

考虑一般的 $M$ 进制波形传输系统，传输的波形形式为
$$
x(t) = x p(t)
$$
其中，$x \in \mathscr{A}$ 来自 $M$ 进制[[电平信道#多进制电平信道的构造|电平信道]]，$p(t)$ 为能量归一化的成形脉冲。

> [!thm.] 多进制波形传输的最佳接收
> 对于一般的 $M$ 进制传输波形 $x(t) = xp(t)$（其中 $x \in \mathscr{A}$，成形脉冲 $p(t)$ 满足**能量归一化**条件），在 AWGN 波形信道 $y(t) = x(t) + z(t)$ 上传输，其**最佳接收**处理为
> $$
> y = \dint_{-\infty}^{+\infty} y(t) \cdot p(t) \dif t = x + z
> $$
> 其中 $z \sim \mathcal{N}\left( 0, \cfrac{n_{0}}{2} \right)$，该等效电平信道的**信噪比**为 $\mathrm{SNR} = \cfrac{E_{\mathrm{s}}}{n_{0} / 2}$。

### 成形脉冲未归一化的情况

对于**未归一化**的成形脉冲 $p(t)$，不妨设 $p(t) = \sqrt{ E_{p} } \hat{p}(t)$ 且 $\hat{p}(t)$ 满足能量归一化条件，考虑使用相同的线性处理方式，则
$$
\begin{align} 
y &= \dint_{-\infty}^{+\infty} y(t) \cdot p(t) \dif t = \dint_{-\infty}^{+\infty} x(t) \cdot p(t) \dif t + \dint_{-\infty}^{+\infty} z(t) \cdot p(t) \dif t \\
&= x \dint_{-\infty}^{+\infty} p^{2}(t) \dif t + \dint_{-\infty}^{+\infty} z(t) \cdot p(t) \dif t \\
&= E_{p} x + z
\end{align}
$$
其中等价噪声电平
$$
z = \dint_{-\infty}^{+\infty} z(t) \cdot p(t) \dif t \sim \mathcal{N}\left( 0, \dfrac{n_{0}}{2} \dint_{-\infty}^{+\infty} p^{2}(t) \dif t  \right)
= \mathcal{N}\left( 0, \dfrac{n_{0}}{2} E_{p} \right)
$$
即该等效电平信道的**信噪比**为
$$
\mathrm{SNR} = \dfrac{ E_{p}^{2} \sigma^{2}_{x} }{ \left( n_{0} / 2 \right) E_{p} } = \dfrac{ E_{p} E_{\mathrm{s}} }{ n_{0} / 2 }
$$

## 最佳接收的实现

### 线性调制波形接收的实现

对于以**归一化**成形脉冲 $p(t)$ **线性调制**的波形传输系统，已知最佳接收处理为
$$
y = \dint_{-\infty}^{+\infty} y(t) \cdot p(t) \dif t
$$
除开使用**积分器**实现该处理外，还可以使用**匹配滤波器 (matched filter)** 实现为：

![[波形信道最佳接收 匹配滤波.png|使用滤波器实现最佳接收]]

其中，滤波器的冲激响应为 $p(-t)$，输出即为
$$
\t{y}(t) = y(t) * p(-t) = \dint_{-\infty}^{+\infty} y(\tau) p(-(t - \tau)) \dif \tau = \dint_{-\infty}^{+\infty} y(\tau) p(\tau - t) \dif \tau
$$
因此，在时刻 $t = 0$ 处抽样，即可得到最佳接收结果
$$
y = \t{y}(0) = \dint_{-\infty}^{+\infty} y(\tau) p(\tau) \dif \tau
$$

### 波形传输的收发联合模型

波形信道的发送端为
$$
x(t) = x p(t) = x\delta(t) * p(t)
$$
同样具有**滤波器**的实现形式。因此，可以把收发两端的滤波器形式放在一个视野中，得到如下**收发联合模型**：

![[波形信道最佳接收 收发联合.png|波形传输的收发联合模型]]

信号部分的整个传输过程同样是 LTI 系统，整体的冲激响应为
$$
h(t) = p(t) * p(-t)
$$
从频域来看，传输系统的频率响应为
$$
H(f) = \mathcal{F} \left\{ p(t) * p(-t) \right\} = P(f) \cdot P^{*}(f) = | P(f) |^{2}
$$

![[波形信道最佳接收 收发联合等效.png|波形传输的收发联合等效滤波器]]

### 成形脉冲与匹配脉冲的放缩

考虑使用一般的成形脉冲 $f(t)$ 和匹配脉冲 $g(t)$，接收处理为
$$
\begin{align} 
y &= \dint_{-\infty}^{+\infty} y(t) g(t) \dif t = \dint_{-\infty}^{+\infty} x(t) g(t) \dif t + \dint_{-\infty}^{+\infty} z(t) g(t) \dif t  \\
&= x \dint_{-\infty}^{+\infty} f(t) g(t) \dif t + \dint_{-\infty}^{+\infty} z(t) \cdot g(t) \dif t
\end{align}
$$

![[波形信道最佳接收 收发联合 不归一化.png]]

考虑**最佳接收**的条件，要求成形脉冲与匹配脉冲满足
$$
f(t) = \beta_{1} p(t), \qquad g(t) = \beta_{2} p(t)
$$
其中 $p(t)$ 满足**能量归一化**条件，$\beta_{1}, \beta_{2} > 0$。此时，**等效电平信道**为
$$
y = \beta_{1} \beta_{2} x + z, \qquad z \sim \mathcal{N}\left( 0, \dfrac{n_{0}}{2} \beta_{2}^{2} \right)
$$
其**信噪比**为
$$
\mathrm{SNR} = \cfrac{ \beta_{1}^{2} \beta_{2}^{2} \sigma^{2}_{x} }{ \dfrac{n_{0}}{2} \beta_{2}^{2} } = \dfrac{ \beta_{1}^{2} \sigma_{x}^{2} }{ n_{0} / 2 }
$$
因此，**成形脉冲的放缩系数 $\beta_{1}$ 决定了信噪比的高低**，而匹配脉冲的放缩系数 $\beta_{2}$ 则不会影响信噪比。

若只给定等效系统的 $h(t)$ 或 $H(f)$，有
$$
\dint_{-\infty}^{+\infty} H(f) \dif f = h(0) = \dint_{-\infty}^{+\infty} f(\tau) g(\tau) \dif \tau = \beta_{1} \beta_{2}
$$
当可**确定 $f(t) = g(t)$** 时，即知 $\beta_{1} = \sqrt{ h(0) } = \sqrt{ \dint_{-\infty}^{+\infty} H(f) \dif f }$，可由此确定信噪比；否则，只能确定波形能量与电平能量的比值。