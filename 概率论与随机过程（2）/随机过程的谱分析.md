## 随机过程的谱

### 相关函数的谱表示

#### 正定函数的 Fourier 变换

对 $\e^{\J \omega t}$，显然有
$$
\big( \e^{\J\omega (t_{i} - t_{j})} \big)_{i,j} = \v{g} \v{g}^{\mathrm{H}}, \quad \v{g} = \big( \e^{\J\omega t_{1}}, \e^{\J\omega t_{2}}, \ldots, \e^{\J\omega t_{n}} \big)^{\mathrm{T}}
$$
因此 $\e^{\J \omega t}$ 是正定的。进而，对任意实函数 $\hat{f}(\omega) \geq 0$，有 **Fourier 逆变换**函数
$$
f(t) = \dfrac{1}{2\pi} \int_{-\infty}^{+\infty} \hat{f}(\omega) \e^{\J\omega t} \dif \omega
$$
是**正定**的。

另一方面，若 $f(t)$ 是正定的，则对任意整数 $n$ 和任意实数 $t_{1}, t_{2}, \ldots, t_{n}$，矩阵 $\big( f(t_{i} - t_{j}) \big)_{i,j}$ 也是正定的。特别地，取定 $\v{x} = \big( \e^{-\J \omega t_{1}}, \e^{-\J\omega t_{2}}, \cdots, \e^{-\J\omega t_{n}}\big)$，则正定性要求
$$
\v{x}^{\mathrm{H}} \big( f(t_{i} - t_{j}) \big)_{i,j} \v{x} 
= \sum\limits_{i=1}^{n} \sum\limits_{j=1}^{n} f(t_{i} - t_{j}) \e^{-\J \omega (t_{i} - t_{j})} \geq 0
$$
进而
$$
\dfrac{1}{T} \dint_{-T}^{T} \dint_{-T}^{T} f(t-s) \e^{-\J\omega (t-s)} \dif t  \dif s \ge 0
$$
做变量替换 $u = t-s$，$v = t + s$，Jacobian 行列式为 $\left| \dfrac{ \partial (t,s) }{ \partial (u,v) } \right| = \dfrac{1}{2}$，积分区域变为 $|u| \leq 2T$、$|v| \leq 2T - |u|$ 的菱形，因此
$$
\begin{align}
\mathrm{LHS} &= \dfrac{1}{T} \dint_{-2T}^{2T} \dint_{|u| - 2T}^{2T - |u|} f(u) \e^{-\J \omega u} \cdot \frac{1}{2} \dif v \dif u \\
&= \dfrac{1}{2T} \dint_{-2T}^{2T} f(u) \e^{-\J \omega u} (4T - 2|u|) \dif u 
= \dint_{-2T}^{2T} \left( 2 - \dfrac{|u|}{T} \right)  f(u) \e^{-\J \omega u} \dif u  \\
&\xrightarrow[\text{Lebesgue dominated}]{T \to +\infty} 2\dint_{-\infty}^{+\infty} f(u) \e^{-\J \omega u} \dif u \geq 0
\end{align}
$$
因此，**正定函数 $f(t)$ 的 Fourier 变换**
$$
\hat{f}(\omega) = \dint_{-\infty}^{+\infty} f(t) \e^{-\J \omega t} \dif t \geq 0
$$
**非负**。

> [!theorem] 正定函数与 Fourier 变换的关系
> 函数 $f(t)$ 是**正定**的，当且仅当其 **Fourier 变换 $\hat{f}(\omega)$ 非负**。

#### 随机过程的功率谱

对于一般的随机过程 $X(t)$，不能保证 $\dint |X(t)| \dif t < \infty$，因此不能直接进行 Fourier 变换。

随机过程的**功率谱 (power spectrum)** 定义为随机过程 $X_{T}(t)$ 的**截断** Fourier 变换 (STFT) 的模平方期望的极限。

> [!definition] 随机过程的功率谱密度
> 对于随机过程 $X(t)$，定义其**功率谱密度 (power spectrum density)** 为
> $$
> S_{X}(\omega) = \lim_{T \to +\infty} \dfrac{1}{2T} \mathbb{E}\left[ \left| \dint_{-T}^{T} X(t) \e^{-\J \omega t} \dif t \right|^2 \right]
> $$

显然，$S_{X}(\omega) \geq 0$；展开后，有
$$
\begin{align}
S_{X}(\omega) &= \lim_{T \to +\infty} \dfrac{1}{2T} \mathbb{E}\left[ \left( \dint_{-T}^{T} X(t) \e^{-\J \omega t} \dif t \right) \left( \dint_{-T}^{T} X(s) \e^{\J \omega s} \dif s \right)^{*} \right] \\
&= \lim\limits_{ T \to +\infty } \dfrac{1}{2T} \dint_{-T}^{T} \dint_{-T}^{T} \mathbb{E}[X(t) X^{*}(s)] \e^{-\J \omega (t-s)} \dif t \dif s \\
&= \dint_{-\infty}^{+\infty} R_{X}(u) \e^{-\J \omega u} \dif u = \mathscr{F}\{R_{X}(t)\}
\end{align}
$$

> [!theorem] Wiener-Khinchin 关系
> 随机过程 $X(t)$ 的**功率谱密度 $S_{X}(\omega)$ 是其相关函数 $R_{X}(t)$ 的 Fourier 变换**，即
> $$
> S_{X}(\omega) = \mathscr{F}\{R_{X}(t)\} = \dint_{-\infty}^{+\infty} R_{X}(t) \e^{-\J \omega t} \dif t
> $$
> 反之，
> $$
> R_{X}(t) = \mathscr{F}^{-1}\{S_{X}(\omega)\} = \dfrac{1}{2\pi} \dint_{-\infty}^{+\infty} S_{X}(\omega) \e^{\J \omega t} \dif \omega
> $$

> [!note] 功率谱的物理意义
> 功率谱描述随机过程**在不同频率上的功率分布**情况。对功率谱 $S_{X}(\omega)$ 在全频域积分，有
> $$
> \dint_{-\infty}^{+\infty} S_{X}(\omega) \dif \omega = 2\pi R_{X}(0) = 2\pi \mathbb{E}\left[|X(t)|^2\right]
> $$

### 功率谱的性质

#### 功率谱的奇偶虚实性

对于**实值 w.s.s.** 随机过程 $X(t)$，相关函数 $R_{X}(\tau) = \mathbb{E}\left[ X(t)X(t + \tau) \right]$ 即为**实值偶函数**，因此
$$
\begin{align}
S_{X}(\omega) &= \dint_{-\infty}^{+\infty} R_{X}(t) \e^{-\J \omega t} \dif t \\
&= \dint_{-\infty}^{+\infty} R_{X}(t) \cos(\omega t) \dif t - \J \dint_{-\infty}^{+\infty} \underbrace{ R_{X}(t) \sin(\omega t) }_{ \text{odd} } \dif t \\
&= \dint_{-\infty}^{+\infty} R_{X}(t) \cos(\omega t) \dif t = S_{X}(-\omega)
\end{align}
$$
功率谱 $S_{X}(\omega)$ 也为**实值偶函数**。

## 随机过程通过 LTI 系统

### LTI 系统对宽平稳随机过程的作用

以 **w.s.s. 随机过程 $X(t)$** 作为**线性时不变 (LTI) 系统 $h(t)$** 的输入，输出为随机过程 $Y(t)$，则
$$
Y(t) = X(t) * h(t) = \dint_{-\infty}^{+\infty} X(\tau) h(t - \tau) \dif \tau
$$
因此
$$
\begin{align}
R_{Y}(t, s) &= \mathbb{E}[Y(t) Y(s)] \\
&= \mathbb{E}\left[ \left( \dint_{-\infty}^{+\infty} X(\tau) h(t - \tau) \dif \tau \right) \left( \dint_{-\infty}^{+\infty} X(\sigma) h(s - \sigma) \dif \sigma \right) \right] \\
&= \dint_{-\infty}^{+\infty} \dint_{-\infty}^{+\infty} h(t - \tau) h(s - \sigma) \mathbb{E}[X(\tau) X(\sigma)] \dif \tau \dif \sigma \\
&= \dint_{-\infty}^{+\infty} \dint_{-\infty}^{+\infty} h(t - \tau) h(s - \sigma) R_{X}(\tau - \sigma) \dif \tau \dif \sigma
\end{align}
$$
记 $\t{h}(t) = h(-t)$，则
$$
R_{Y}(t, s) = \left( R_{X} * h * \t{h} \right) (t - s) 
$$
因此，$Y(t)$ 也是 **w.s.s. 随机过程**，其**谱**函数为
$$
S_{Y}(\omega) = \mathscr{F} \left\{ R_{X} * h * \t{h} \right\} = S_{X}(\omega) \cdot H(\omega) \cdot \t{H}(\omega)
$$
而
$$
\t{H}(\omega) = \dint_{-\infty}^{+\infty} h(-t) \e^{-\J \omega t} \dif t = \dint_{-\infty}^{+\infty} h(u) \e^{\J \omega u} \dif u = H^{*}(\omega)
$$
因此
$$
S_{Y}(\omega) = S_{X}(\omega) \cdot H(\omega) \cdot H^{*}(\omega) = \bbox[5pt]{ S_{X}(\omega) |H(\omega)|^2 }
$$
其中 $H(\omega)$ 是系统 $h(t)$ 的**频率响应 (frequency response)**。

> [!example] E.g. 积分器对随机过程的作用
> 设随机过程 $X(t)$ 的功率谱密度为 $S_{X}(\omega)$，经过积分器
> $$
> Y(t) = \dfrac{1}{T} \dint_{t - T/2}^{t + T/2} X(\tau) \dif \tau
> $$
> 即 $h(t) = \begin{cases}  \dfrac{1}{T}, & |t| \leq \dfrac{T}{2} \\ 0, & |t| > \dfrac{T}{2} \end{cases}$，其频率响应为
> $$
> H(\omega) = \dint_{-\infty}^{+\infty} h(t) \e^{-\J \omega t} \dif t = \dfrac{1}{T} \dint_{-T/2}^{T/2} \e^{-\J \omega t} \dif t = \dfrac{\sin(\omega T/2)}{\omega T/2}
> $$
> 因此，输出随机过程 $Y(t)$ 的功率谱密度为
> $$
> S_{Y}(\omega) = S_{X}(\omega) \cdot \dfrac{4\sin^{2}(\omega T/2)}{\omega^2 T^2}
> $$

> [!example]- E.g. 递推关系
> 

> [!example]- E.g. 白噪声通过 LTI 系统
> 考虑随机过程 $B(t)$ 满足
> $$
> \mathbb{E}\left[ B(t) \right] = 0, \qquad R_{B}(t, s) = \min (t, s)
> $$
> 则 $B(t)$ 的增量过程 $Y(t) = \dfrac{\dif}{\dif t} B(t)$ 的相关为
> $$
> \begin{align}
> R_{Y}(t, s) &= \mathbb{E}\left[ Y(t) Y(s) \right] = \mathbb{E}\left[ \dfrac{\dif}{\dif t} B(t) \dfrac{\dif}{\dif s} B_{s} \right] \\
> &= \dfrac{\partial^2}{\partial t \partial s} R_{B}(t, s) = \dfrac{\partial^2}{\partial t \partial s} \min(t, s)  \\
> &= \dfrac{\partial^2}{\partial t \partial s} \dfrac{t + s - |t - s|}{2} = - \dfrac{1}{2} \dfrac{\partial^2}{\partial t \partial s} |t - s| = \delta(t - s)
> \end{align}
> $$
> $B(t)$ 称为 **Brown 运动 (Brownian motion)**，$Y(t)$ 称为**白噪声 (white noise)**。尽管 Brown 运动不是平稳的，其导数**白噪声是宽平稳过程**。
> 
> 白噪声的功率谱密度为
> $$
> S_{Y}(\omega) = \mathscr{F}\{ R_{Y}(t) \} = \mathscr{F}\{\delta(t)\} = 1
> $$

## 随机过程的互功率谱

### 互功率谱的定义

对于两个**宽平稳随机过程 $X(t)$ 和 $Y(t)$**，其互相关函数为
$$
R_{XY}(\tau) = \mathbb{E}\left[ X(t + \tau) \overline{ Y(t) } \right],\qquad
R_{YX}(\tau) = \mathbb{E}\left[ Y(t + \tau) \overline{ X(t) } \right]
$$

考虑 $X(t)$ 通过 LTI 系统 $H(\omega)$ 得到输出 $Y(t)$，做谱分解
$$
\begin{align} 
&X(t) = \dint_{-\infty}^{+\infty} \e^{\J \omega t} \dif F_{X}(\omega), \\
&Y(t) = \dint_{-\infty}^{+\infty} \e^{\J \omega t} \dif F_{Y}(\omega) = \dint_{-\infty}^{+\infty} \e^{\J \omega t} H(\omega) \dif F_{X}(\omega)
\end{align}
$$
得到
$$
\begin{align}
R_{XY}(\tau) &= \mathbb{E}\left[ X(t + \tau) \overline{ Y(t) } \right] \\
&= \mathbb{E} \left[ \left( \dint_{-\infty}^{+\infty} \e^{\J \omega_{1} (t + \tau)} \dif F_{X}(\omega_{1}) \right) \left( \dint_{-\infty}^{+\infty} \e^{-\J \omega_{2} t} \overline{ H(\omega_{2}) } \dif \overline{F_{X}(\omega_{2})} \right) \right] \\
&= \dint_{-\infty}^{+\infty} \dint_{-\infty}^{+\infty} \e^{\J \omega_{1} \tau} \overline{ H(\omega_{2}) } \mathbb{E}\left[ \dif F_{X}(\omega_{1}) \dif \overline{F_{X}(\omega_{2})} \right] \\
&= \dfrac{1}{2\pi} \dint_{-\infty}^{+\infty} \e^{\J \omega \tau} \overline{ H(\omega) } S_{X}(\omega) \dif \omega
\end{align}
$$
因此，类比功率谱密度的定义，我们期望有
$$
R_{XY}(\tau) = \dfrac{1}{2\pi} \dint_{-\infty}^{+\infty} \underbrace{ \overline{ H(\omega) } S_{X}(\omega) }_{ S_{XY}(\omega) } \e^{\J \omega \tau} \dif \omega
$$

> [!definition] 互功率谱密度
> 对于两个宽平稳随机过程 $X(t)$ 和 $Y(t)$，定义其**互功率谱密度 (cross power spectrum density)** 为
> $$
> S_{XY}(\omega) = \mathscr{F}\{ R_{XY}(\tau) \} = \dint_{-\infty}^{+\infty} R_{XY}(\tau) \e^{-\J \omega \tau} \dif \tau
> $$
> 其中 $R_{XY}(\tau) = \mathbb{E}\left[ X(t + \tau) \overline{ Y(t) } \right]$ 为互相关函数。

