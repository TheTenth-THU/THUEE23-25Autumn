## History of Computer Architecture, <br>计算机架构的发展历史 

### Source Concepts, 源头概念

#### Finite State Machine, 有限状态机

**有限状态机 (finite state machine, FSM)** 是一种数学模型，用于描述具有有限数量状态的系统。它由以下几个部分组成：
+ **状态 (states)**: 系统可能处于的不同状态集合。
+ **输入 (inputs)**: 系统可以接收的外部信号或事件。
+ **输出 (outputs)**: 系统在不同状态下根据输入产生的响应。
+ **初始状态 $S_{0}$**: 系统开始时的状态。
+ **输出函数 $f: (\text{Inputs},\text{States}) \mapsto \text{Outputs}$**: 描述系统在特定状态下对输入的响应。
+ **状态转移 (state transitions) 函数 $g: (\text{Inputs},\text{States}) \mapsto \text{States}^{*}$**: 描述系统如何从一个状态转换到另一个状态。

FSM 有两种主要类型：
+ **Mealy 机**: 输出依赖于当前状态和输入。
+ **Moore 机**: 输出仅依赖于当前状态。

![[Mealy 机与 Moore 机.png|两类有限状态机的基本结构]]

FSM 通常实现为**组合逻辑**与**锁存器 (latch)** 的组合。组合逻辑根据当前状态和输入生成输出和下一个状态，而锁存器用于存储当前状态。

#### Micro-programmed Controllers, 微程序控制器

微程序控制器是一种通过读取 ROM 中的**微指令 (microinstructions)** 来生成控制信号、实现控制逻辑的 FSM，其部分状态是**微程序计数器 (micro-program-counter, micro-PC)**， 用于指示当前执行的微指令地址。

### Hardware Parallelism, 硬件并行

#### Pipelined RISC, 流水线精简指令集计算机

**RISC (reduced instruction set computer)** 是一种计算机架构设计理念，强调使用简化的指令集以提高执行效率。RISC 架构的特点包括：
+ **指令集简单固定**: RISC 指令通常长度短小、格式固定，易于解码，便于执行。
+ **寄存器存储信息**: RISC 处理器通常配备大量通用寄存器，以减少对内存访问的需求，除了使用 load/store 指令来访问内存外，其他操作仅在寄存器之间进行。
+ **流水线 (pipelining) 加速执行**: RISC 处理器通常采用流水线技术，将指令执行过程分解为多个阶段，以提高指令吞吐量。

![[流水线化的指令执行.png|流水线化的指令执行]]

**流水线**技术可视为**指令级并行 (instruction-level parallelism, ILP)** 的第 1 代实现。通过将指令执行过程划分为多个阶段（如取指、译码、执行、访存、写回），流水线允许多个指令同时处于不同的执行阶段，从而提高整体处理器的吞吐量。

#### Superscalar Processors, 超标量处理器

**超标量 (superscalar)** 技术是指凭借片上的多个执行单元，处理器能够在每个时钟周期内发射和执行多条指令。

为在超标量下处理指令依赖、完成指令调度，可以引入**超长指令字 (very long instruction word, VLIW)**，它将多条独立指令打包成一个更长的指令字，由**编译器**负责指令调度和并行管理。

![[IBM Power 4.png|IBM Power 4 处理器，结合了超标量与乱序执行技术]]

#### Multithreading, 多线程

**多线程 (multithreading)** 是指在**单个处理器核心**上同时管理和执行多个线程。通过多线程，处理器可以在一个线程等待 I/O 操作或其他事件时，切换到另一个线程继续执行，从而提高资源利用率和整体性能。

多线程有两种主要类型：
+ **粗粒度多线程 (coarse-grained multithreading)**: 处理器在一个线程遇到长时间延迟（如内存访问）时，切换到另一个线程继续执行。
+ **细粒度多线程 (fine-grained multithreading)**: 处理器在每个时钟周期内切换线程，以最大化资源利用率。

> [!note] 线程 (thread) 与进程 (process) 的区别
> **线程 (thread)** 是操作系统调度的基本单位，属于**进程 (process)** 的一部分，共享进程的资源（如内存空间、文件句柄等），但拥有自己的寄存器状态和栈。
> 
> **多线程**允许在单个进程内并发执行多个任务，只需要有多个**资源槽位 (slot)**，而**多进程**则涉及多个独立的资源空间，一般需要多个处理器核心来实现。 
> 
> ![[线程执行.png|不同的线程并行执行方式]]

#### Vector Processing, 向量处理

**向量处理 (vector processing)** 是一种并行计算技术，专门用于处理大量数据的相同操作。向量处理器能够同时对多个数据元素执行相同的操作，从而显著提高性能。

典型的向量处理器如 **GPU (graphics processing unit)**，它们设计用于高效处理图形和图像数据，但也广泛应用于科学计算和机器学习等领域。

### Software Parallelism, 软件并行

进入 21 世纪后，硬件层面的并行技术逐渐成熟，尽管片上晶体管密度仍以 Moore 定律增长，但**时钟频率提升乏力**，单核性能提升有限，而每块芯片处理器核的数量开始增长。为进一步提升计算性能，软件层面的并行技术变得尤为重要。

**多指令流多数据流 (multiple instruction, multiple data, MIMD)** 是现代计算系统的主要并行计算模型，强调通过多个处理器核心同时执行不同的指令流来处理不同的数据流。实例如：
+ **对称多处理器 (symmetric multiprocessor, SMP) 架构**：
	多个处理器核心共享统一内存，每个处理器独立运行操作系统实例。
+ **通过主机 (host) 实现独立 I/O 的非均匀共享内存 (non-uniform shared-memory) 架构**：
	多个处理器核心各自拥有本地内存形成可扩展的通用网络，共享内存访问时间随物理位置变化，每个节点搭载级间操作系统，通过主机实现独立 I/O。
+ **集群 (cluster)**：
	通过高速网络连接的多台计算机协同工作，每台计算机独立运行操作系统实例。

