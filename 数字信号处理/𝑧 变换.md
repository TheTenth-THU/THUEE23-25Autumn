## $z$ 变换的定义

> [!def.] 双边 $z$ 变换
> 设离散时间信号 $x[n]$，其**双边 $z$ 变换**定义为
> $$
> X(z) = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
> $$
> 记作 $X(z) = \mathscr{Z}\left\{ x[n] \right\}$，其中 $z$ 为复变量，通常表示为 $z = r \e^{\J \omega}$，$r$ 为模长，$\omega$ 为相位角。

### $z$ 变换的收敛域

由于 $z$ 变换式为无穷 Laurent 级数，其**敛散性**取决于 $z$ 的取值范围。对于不同的信号 $x[n]$，其 $z$ 变换的**收敛域 (region of convergence, ROC)** 也不同。

```tx
| 序列类型 || $z$ 变换式 $\mathscr{Z}\left\{ x[n] \right\}$ | 收敛域 (ROC) |
|:------|:--|:-----------|:-------------|
| 有限长序列 | $n_1 < 0$，$n_2 > 0$ | $X(z) = \sum\limits_{n=n_1}^{n_2} x[n] z^{-n}$ | $0 < \lvert z \rvert < \infty$ |
| ^^         | $n_1 < 0$，$n_2 \le 0$ | ^^ | $0 \le \lvert z \rvert < \infty$ |
| ^^         | $n_1 \ge 0$，$n_2 > 0$ | ^^ | $0 < \lvert z \rvert \le \infty$ |
| 右边序列  || $X(z) = \sum\limits_{n=n_0}^{\infty} x[n] z^{-n}$ | $\lvert z \rvert > r$ |
| 左边序列  || $X(z) = \sum\limits_{n=-\infty}^{n_0} x[n] z^{-n}$ | $\lvert z \rvert < r$ |
| 双边序列  || $X(z) = \sum\limits_{n=-\infty}^{\infty} x[n] z^{-n}$ | $r_1 < \lvert z \rvert < r_2$ |
```

> [!example] $z$ 变换的收敛域举例
> 考虑**双边序列 $x[n] = a^{|n|}$**，其 $z$ 变换为
> $$
> X(z) = \sum_{n=-\infty}^{\infty} a^{|n|} z^{-n} = \sum_{n=0}^{\infty} a^{n} z^{-n} + \sum_{n=1}^{\infty} a^{n} z^{n} = \dfrac{1}{1 - az^{-1}} + \dfrac{az}{1 - az}
> $$
> 两部分**分别是 $az^{-1}$ 和 $az$ 的几何级数**，其收敛分别要求 $\lvert z \rvert > \lvert a \rvert$ 和 $\lvert z \rvert < \dfrac{1}{\lvert a \rvert}$，因此整体的收敛域为
> $$
> \lvert a \rvert < \lvert z \rvert < \dfrac{1}{\lvert a \rvert}
> $$
> 当 $| a | \ge 1$ 时，收敛域不存在。

**因果**系统的 $z$ 变换收敛域为 $\lvert z \rvert > r$，其中 $r$ 为系统**最大模值极点的模值**；**稳定**系统的 $z$ 变换收敛域包含单位圆 $\lvert z \rvert = 1$。因此，**因果且稳定**系统要求其**所有极点均位于 $z$ 平面单位圆内**。

### 逆 $z$ 变换

由 Cauchy 积分定理，$z$ 变换具有唯一的逆变换，其表达式为
$$
\begin{align} 
\dfrac{1}{2\pi\J} \oint_{C} z^{n-1} X(z) \dif z &= \dfrac{1}{2\pi\J} \oint_{C} z^{n-1} \left( \sum_{m=-\infty}^{\infty} x[m] z^{-m} \right) \dif z \\
&= \dfrac{1}{2\pi\J} \sum_{m=-\infty}^{\infty} x[m] \oint_{C} z^{n-m-1} \dif z \\
&= \sum_{m=-\infty}^{\infty} x[m] \delta[n-m] = x[n]
\end{align}
$$

> [!def.] 逆 $z$ 变换
> 设信号 $x[n]$ 的 $z$ 变换为 $X(z)$，则其**逆 $z$ 变换**定义为
> $$
> x[n] = \mathscr{Z}^{-1}\left\{ X(z) \right\} = \dfrac{1}{2\pi \J} \oint_{C} z^{n-1} X(z) \dif z
> $$
> 其中积分路径 $C$ 为包含收敛域的闭合曲线。

#### 留数法求逆 $z$ 变换

逆 $z$ 变换的积分式可通过**留数定理**计算。设 $X(z)$ 在收敛域**内边界环内**有有限个极点 $\left\{ z_{k} \right\}$，在**外边界环外**有有限个极点 $\left\{ z_{m} \right\}$，则
$$
\begin{align}
x[n] &= \dfrac{1}{2\pi \J} \oint_{C} z^{n-1} X_{\mathrm{R}}(z) \dif z + \dfrac{1}{2\pi \J} \oint_{C} z^{n-1} X_{\mathrm{L}}(z) \dif z \\
&= \sum_{k} \text{Res}\left\{ z^{n-1} X_{\mathrm{R}}(z), z_{k} \right\} u[n] - \sum_{m} \text{Res}\left\{ z^{n-1} X_{\mathrm{L}}(z), z_{m} \right\} u[-n-1]
\end{align}
$$
其中，**留数**定义为
$$
\text{Res}\left\{ f(z), z_{0} \right\} = \dfrac{1}{(m-1)!} \lim_{z \to z_{0}} \dfrac{\dif^{m-1}}{\dif z^{m-1}} \left( (z - z_{0})^{m} f(z) \right)
$$
其中 $m$ 为极点 $z_{0}$ 的阶数。

#### 部分分式展开法求逆 $z$ 变换

对于有理式 $z$ 变换 $X(z) = \cfrac{N(z)}{D(z)}$，可以通过**部分分式展开**将其拆分为简单项的和，然后对每一项分别求逆 $z$ 变换，再将结果相加。

设 $X(z)$ 可分解为
$$
\begin{align}
X(z) &= \dfrac{\sum\limits_{r=0}^{M} b_{r} z^{-r}}{1 + \sum\limits_{k=1}^{N} a_{k} z^{-k}} \\
&= \sum\limits_{m=0}^{M-N} B_{m} z^{-m} + \sum\limits_{k=1}^{N_{1}} \dfrac{A_{k}}{1 - p_{k} z^{-1}} + \sum\limits_{l=1}^{N_{2}} \sum\limits_{s=1}^{r_{l}} \dfrac{C_{l,s}}{(1 - p_{l} z^{-1})^{s}}
\end{align}
$$
其中，$p_{k}$ 和 $p_{l}$ 分别为**单极点**和**重极点**的位置，$N_{1}$ 和 $N_{2}$ 分别为单极点和重极点的个数，$r_{l}$ 为重极点 $p_{l}$ 的阶数。对于这一分式展开式，各项的逆 $z$ 变换分别为
$$
\begin{align}
z^{-m} \quad&\xrightarrow{\mathscr{Z}^{-1}}\quad \delta[n - m] \\
\dfrac{1}{1 - p_{k} z^{-1}} \quad&\xrightarrow{\mathscr{Z}^{-1}}\quad p_{k}^{n} u[n] \\
\dfrac{1}{(1 - p_{l} z^{-1})^{s}} \quad&\xrightarrow{\mathscr{Z}^{-1}}\quad \dfrac{(n + s - 1)!}{(s - 1)! \, n!} p_{l}^{n} u[n]
\end{align}
$$

## 离散时间系统的 $z$ 变换性质

### 离散时间系统的 $z$ 变换表示

设离散时间系统的输入输出关系为
$$
y[n] + \sum\limits_{k=1}^{N} a_{k} y[n - k] = \sum\limits_{r=0}^{M} b_{r} x[n - r]
$$
则对其做 $z$ 变换，得到**系统函数**
$$
H(z) = \dfrac{Y(z)}{X(z)} = \dfrac{\sum\limits_{r=0}^{M} b_{r} z^{-r}}{1 + \sum\limits_{k=1}^{N} a_{k} z^{-k}}
$$
其中，$X(z) = \mathscr{Z}\left\{ x[n] \right\}$，$Y(z) = \mathscr{Z}\left\{ y[n] \right\}$，系统**冲激响应**即为 $h[n] = \mathscr{Z}^{-1}\left\{ H(z) \right\}$。同时由[[#$z$ 变换的定义|定义]]知，系统的**频率响应**为
$$
H(\e^{\J \omega}) = \sum\limits_{n=-\infty}^{\infty} h[n] \e^{-\J \omega n} = H(z) \big|_{z = \e^{\J \omega}}
$$

频率响应特别是幅频响应对应于系统的外在滤波特性，而系统函数 $H(z)$ 则反映了系统的内在结构实现。若对给定的幅频特性 $A(\e^{\J\omega}) \ge 0$，能够找到**因果稳定**的系统函数 $H(z)$ 使得 $|H(\e^{\J \omega})| = A(\e^{\J \omega})$，则称该幅频特性是**可实现**的，该系统函数即为**幅频特性 $A(\e^{\J \omega})$ 的实现**。

> [!note] 系统的可实现性
> 幅频特性 $A(\e^{\J \omega})$ 可实现的一个**充分必要条件**是 **Paley-Wiener 条件**：
> $$
> \dint_{-\pi}^{\pi} \left\lvert \ln A(\e^{\J \omega}) \right\rvert \dif \omega < \infty
> $$
> 进一步地，若所实现的系统是[[#最小相位系统]]，则该实现是**唯一**的。
> 
> 显然，若幅频特性 $A(\e^{\J \omega})$ 在某一频段内为零，则该幅频特性**不可实现**。一个推论是，在一个频率区间内恒为常数的幅频特性也是不可实现的。

### 逆系统设计

通过设计逆系统，可以实现对原系统的补偿或校正。设离散时间系统的系统函数为 $H(z)$，则其**逆系统**的系统函数自然为 $H_{\mathrm{I}}(z) = \cfrac{1}{H(z)}$，由[[#部分分式展开法求逆 $z$ 变换|部分分式法]]即可求出系统的冲激响应。

广义上，逆系统也可以**容许延迟和缩放**，即
$$
H_{\mathrm{I}}(z) H(z) = C z^{-D}
$$
相应地，
$$
h_{\mathrm{I}}[n] * h[n] = C \delta[n - D]
$$
可以使用**最小二乘**的数值方法设计逆系统，以近似满足上述关系，最小化均方误差
$$
\sum\limits_{n} \left| h_{\mathrm{I}}[n] * h[n] * x[n] - x[n - D] \right|^{2}
$$

原线性系统可表示为
$$
\v{y} = \boldsymbol{A}_{h} \v{x}
$$
其中，$\boldsymbol{A}_{h}$ 为**卷积矩阵**
$$
\boldsymbol{A}_{h} = \begin{pmatrix}
h[0] \\
h[1] & h[0] \\
h[2] & h[1] & h[0] \\
\vdots & \vdots & \vdots & \ddots 
\end{pmatrix}
$$
则求解逆系统等价于最小二乘求解
$$
\boldsymbol{A}_{h} \v{h}_{\mathrm{I}} \cong \v{e}_{D}
$$
其中 $\v{e}_{D}$ 为第 $D$ 个位置为 $1$，其余位置为 $0$ 的单位向量。根据最小二乘解的正规方程，有
$$
\hat{\v{h}}_{\mathrm{I}} = \left( \boldsymbol{A}_{h}^{\mathrm{H}} \boldsymbol{A}_{h} \right)^{-1} \boldsymbol{A}_{h}^{\mathrm{H}} \v{e}_{D}
$$

### 全通系统和最小相位系统

#### 全通系统

全通系统是指**幅频特性恒为常数**的系统，其系统函数满足
$$
|H_{\mathrm{ap}}(\e^{\J \omega})| = C, \qquad -\pi \le \omega < \pi
$$
全通系统的系统函数可表示为
$$
H_{\mathrm{ap}}(z) = C \prod\limits_{k=1}^{N} \dfrac{-1}{p_{k}^{*}}\dfrac{z^{-1} - p_{k}^{*}}{1 - p_{k} z^{-1}} = G \prod\limits_{k=1}^{N} \dfrac{z^{-1} - p_{k}^{*}}{1 - p_{k} z^{-1}}
$$
即系统的零点和极点以 $\begin{cases}z_{\mathrm{p}} = p_{k}, \\ z_{\mathrm{o}} = (p_{k}^{*})^{-1}\end{cases}$ 的方式成对出现，**关于单位圆对称分布**。

我们取一对零极点 $\left( \cfrac{1}{r} \e^{\J\varphi}, r\e^{\J\varphi} \right)$ 来分析，该全通系统为
$$
H(z) = G \dfrac{z^{-1} - r\e^{-\J\varphi}}{1 - r \e^{\J\varphi} z^{-1}}
$$
其**相频特性**为
$$
\arg H(\e^{\J \omega}) = \arg G + \tan^{-1} \dfrac{(1 - r^{2}) \sin(\omega - \varphi)}{(1 - r^{2}) \cos(\omega - \varphi) + r \left( 1 - 2r \cos(\omega - \varphi) + r^{2} \right)}
$$

#### 最小相位系统

最小相位系统是指**所有零点均位于单位圆内**的系统；若系统稳定、因果，则其**所有零极点均位于单位圆内**。

最小相位系统具有**最小群时延**的特性，即在所有具有相同幅频特性的因果稳定系统中，最小相位系统的群时延 $\tau_{\mathrm{g}}(\omega) = -\cfrac{\dif \arg H(\e^{\J \omega})}{\dif \omega}$ 最小；因此，在幅频特性相同的因果稳定系统中，最小相位系统具有**最小能量延迟**特性，能够最快响应输入信号的能量变化。

> [!theorem] 系统的最小相位分解
> 任意系统均可分解为**最小相位部分**和**全通部分**的乘积
> $$
> H(z) = H_{\mathrm{min}}(z) H_{\mathrm{ap}}(z)
> $$

最小相位分解的实现过程为：对系统的每个**单位圆外零点** $z_{\mathrm{o}} = r\e^{\J\varphi}$（$r>1$），引入一个在该处有极点、在对应的单位圆内位置 $z_{\mathrm{o}}' = (z_{\mathrm{o}}^{*})^{-1} = \cfrac{1}{r} \e^{\J\varphi}$ 有零点的全通系统，得到
$$
z^{-1} - z_{\mathrm{o}}^{-1} = (1 - z_{\mathrm{o}}' z^{-1}) \cdot \dfrac{z^{-1} - z_{\mathrm{o}}^{-1}}{1 - z_{\mathrm{o}}' z^{-1}}
$$

## 典型的离散时间系统

### 数字正弦振荡器

数字正弦振荡器是一种用于生成离散时间正弦波信号的系统。由于保持振荡，其系统函数具有**单位圆上**的**共轭复数极点对**，即极点 $p_{1,2} = \e^{\pm\J\omega_{0}}$，其系统函数为
$$
H(z) = \dfrac{b_{0}}{(1 - \e^{\J\omega_{0}} z^{-1})(1 - \e^{-\J\omega_{0}} z^{-1})} = \dfrac{b_{0}}{1 - 2 \cos \omega_{0} \cdot z^{-1} + z^{-2}}
$$
取 $b_{0} = A \sin\omega_{0}$，则系统的冲激响应为
$$
h[n] = A \sin(\omega_{0} (n+1)) u[n]
$$
$n = 0$ 时刻输入一个单位冲激，系统将输出一个**频率为 $\omega_{0}$，幅度为 $A$ 的正弦波**。

### 数字陷波器

数字陷波器是一种用于抑制特定频率成分的系统。其系统函数具有**单位圆上**的**共轭复数零点对**，即零点 $z_{1,2} = \e^{\pm\J\omega_{0}}$，其系统函数为
$$
H(z) = (1 - \e^{\J\omega_{0}} z^{-1})(1 - \e^{-\J\omega_{0}} z^{-1}) = 1 - 2 \cos \omega_{0} \cdot z^{-1} + z^{-2}
$$
这样得到的系统在频率 $\omega_{0}$ 处具有**零响应**，但 $\omega_{0}$ 附近的频率成分也会受到一定抑制。为了提高陷波器的选择性，可以在附近引入**极点对** $p_{1,2} = r\e^{\pm\J\omega_{0}}$，使得系统函数变为
$$
H(z) = \dfrac{1 - 2 \cos \omega_{0} \cdot z^{-1} + z^{-2}}{1 - 2 r \cos \omega_{0} \cdot z^{-1} + r^{2} z^{-2}}, \qquad 0 < r < 1
$$
这样可以在 $\omega_{0}$ 附近形成**峰值响应**，从而增强陷波效果。

### 梳状滤波器

梳状滤波器是一种具有周期性频率响应的系统，其系统函数为
