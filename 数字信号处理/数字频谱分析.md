## DFT 与连续信号频谱的关系

#### 无限长离散信号加矩形窗

设有无限长离散信号 $s[n]$，其 DTFT 为 $S(\omega)$。对其进行矩形窗截断，得到长度为 $M$ 的有限长信号
$$
s_{M}[n] = s[n] R_{M}[n], \qquad R_{M}[n] = u[n] - u[n - M]
$$
则其 DTFT 为
$$
\begin{align} 
S_{M}(\omega) &= S(\omega) * \mathrm{DTFT}\{ R_{M}[n] \} = S(\omega) * \sum\limits_{n=0}^{M-1} \e^{-\J\omega n} \\
&= S(\omega) * \cfrac{\sin \dfrac{M \omega}{2}}{\sin \dfrac{\omega}{2}} \e^{-\J \tfrac{(M-1)\omega}{2}} \\
\end{align}
$$
对其在 $0 \sim 2\pi$ 范围内均匀采样 $N$ 点（$M$ 不一定等于 $N$），即得到 DFT。

## 用 DFT (FFT) 进行频谱分析

### 一般过程

#### 抗混叠滤波

实际连续信号一般不满足**带限 (bandlimited)** 条件，需先通过**抗混叠滤波器 (anti-aliasing filter)** 限制信号带宽，避免混叠失真。

设[[#采样]]环节的采样率为 $f_{\mathrm{s}}$，则抗混叠滤波器的截止频率须取为 $B_{\text{pass}} < \dfrac{f_{\mathrm{s}}}{2}$。

#### 采样

采样环节将连续时间信号 $s(t)$ 以采样间隔 $T_{\mathrm{s}} = \dfrac{1}{f_{\mathrm{s}}}$ 进行采样，得到离散时间信号 $x[n] = s(nT_{\mathrm{s}})$。

#### 截取、加窗

实际参加频谱分析的信号长度有限，需对离散时间信号进行**截取**，得到有限长信号 $x_{M}[n] = x[n] R_{M}[n]$。为减小截断引起的**频谱泄漏 (spectral leakage)**，通常会对有限长信号进行加窗处理。截取 $M$ 点即等效于乘以矩形窗 $R_{M}[n]$，只不过没有减小旁瓣泄漏的效果。

常用的窗函数如 **Hanning 窗**
$$
w[n] = \dfrac{1}{2} \left( 1 - \cos \dfrac{2\pi n}{M} \right), \quad 0 \le n \le M-1
$$
和 **Hamming 窗**
$$
w[n] = 0.54 - 0.46 \cos \dfrac{2\pi n}{M}, \quad 0 \le n \le M-1
$$

#### 频谱显示

对截取并加窗后的有限长信号 $x_{M}[n]$ 进行 FFT，即得到其 DFT 频谱 $X_{M}[k]$。若想更加「精细」地显示频谱，可以通过**零填充 (zero padding)** 的方式增加 FFT 点数 $N$（$N > M$），使得频谱显示更加平滑。

$M$ 点离散时间信号的 DTFT 频谱由 $M$ 点 DFT **完全表示**，因此这一过程本质上并没有增加频谱信息，只是一种**插值**手段。注意到
$$
\begin{align} 
X_{M}(\omega) &= \sum_{n=0}^{M-1} x_{M}[n] \e^{-\J \omega n} = \sum\limits_{n=0}^{M-1} \left( \dfrac{1}{N} \sum\limits_{k=0}^{N-1} X_{M}[k] \e^{\J 2\pi \tfrac{kn}{N}} \right) \e^{-\J \omega n} \\
&= \sum\limits_{k=0}^{N-1} X_{M}[k] \sum\limits_{n=0}^{M-1} \dfrac{1}{N} \e^{-\J n \left( \omega - 2\pi \tfrac{k}{N} \right)} \\
&= \sum\limits_{k=0}^{N-1} X_{M}[k] \cdot \e^{-\J \tfrac{M-1}{2} \left( \omega - 2\pi \tfrac{k}{M} \right)} \cdot \dfrac{\sin \left( \dfrac{M}{2} \left( \omega - \dfrac{2\pi k}{N} \right) \right)}{\sin \left( \dfrac{1}{2} \left( \omega - \dfrac{2\pi k}{N} \right) \right)}
\end{align}
$$