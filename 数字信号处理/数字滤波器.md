## 典型低通滤波器

![[典型数字低通滤波器的频带分布.png|典型数字低通滤波器的频带分布]]

典型数字低通的主要参数有：
+ **通带截止频率 $\omega_{\mathrm{p}}$**、**阻带截止频率 $\omega_{\mathrm{s}}$**，定义了各频带边界为
	+ 通带：$0 \le |\omega| < \omega_{\mathrm{p}}$
	+ 过渡带：$\omega_{\mathrm{p}} \le |\omega| < \omega_{\mathrm{s}}$
	+ 阻带：$\omega_{\mathrm{s}} \le |\omega| < \pi$
+ **通带峰值波纹 $\delta_{1}$**，定义为通带内增益的最大偏差，即
$$
1 - \delta_{1} \le |H(\e^{\J \omega})| \le 1 + \delta_{1}, \qquad \forall \omega \in [0, \omega_{\mathrm{p}})
$$
通常使用 dB 值表示，即**通带波纹**为 $-20 \log_{10} (1 - \delta_{1})$ dB。
+ **阻带峰值波纹 $\delta_{2}$**，定义为阻带内增益的最大值，即
$$
0 < |H(\e^{\J \omega})| \le \delta_{2}, \qquad \forall \omega \in [\omega_{\mathrm{s}}, \pi)
$$
通常使用 dB 值表示，即**阻带波纹**为 $-20 \log_{10} \delta_{2}$ dB。、

### IIR 滤波器

**IIR (Infinite Impulse Response) 滤波器**是指具有**无限长冲激响应**的数字滤波器，其差分方程形如
$$
y[n] = - \sum\limits_{k=1}^{N} a_{k} y[n-k] + \sum\limits_{r=0}^{M} b_{r} x[n-r]
$$
其系统函数可表示为**有理分式**
$$
H(z) = \dfrac{B(z)}{A(z)} = \dfrac{\sum\limits_{r=0}^{M} b_{r} z^{-r}}{1 + \sum\limits_{k=1}^{N} a_{k} z^{-k}}
$$

#### IIR 的直接 I 型实现

一般地，IIR 滤波器可以拆分成两个**级联**子系统
$$
\begin{cases}
v[n] = \sum\limits_{r=0}^{M} b_{r} x[n-r], & \text{（滑动平均）}\\
y[n] = - \sum\limits_{k=1}^{N} a_{k} y[n-k] + v[n] & \text{（自回归）}
\end{cases}
$$


### FIR 滤波器

**FIR (Finite Impulse Response) 滤波器**是指具有**有限长冲激响应**的数字滤波器，冲激响应 $h(t)$ 时宽有限，意味着系统函数 $H(z)$ 是**有限长多项式**
$$
h[n] = \sum\limits_{k=0}^{M} b_{k} \delta[n-k] \quad\implies\quad H(z) = \sum\limits_{k=0}^{M} b_{k} z^{-k}
$$
故 FIR 滤波器的差分方程为
$$
y[n] = \sum\limits_{k=0}^{M} b_{k} x[n-k]
$$
FIR 滤波器**没有反馈**回路，极点在 $z=0$ 处，天然稳定。

#### FIR 的直接实现

#### FIR 的级联实现

对 FIR 滤波器，其系统函数 $H(z)$ 可分解为若干低阶多项式的乘积
$$
H(z) = A \prod\limits_{k=1}^{M_{1}} (1 - g_{k} z^{-1}) \prod\limits_{l=1}^{M_{2}} (1 - h_{k}z^{-1}) (1 - h_{k}^{*}z^{-1})
$$
其中，$g_{k} \in \mathbb{R}$，$h_{k} \in \mathbb{C}$。则 FIR 滤波器可以实现为多个**一阶和二阶子滤波器的级联**。

#### FIR 的频率取样实现

我们希望直接根据频率响应设计 FIR 滤波器。考虑到
$$
\begin{align}
H(z) &= \sum\limits_{n=0}^{M} h[n] z^{-n} = \sum\limits_{n=0}^{M} z^{-n} \cdot \dfrac{1}{M + 1} \sum\limits_{k=0}^{M} H[k] W_{M+1}^{-kn} \\
&= \dfrac{1}{M + 1} (1 - z^{-(M+1)}) \sum\limits_{k=0}^{M} \dfrac{H[k]}{1 - W_{M+1}^{-k} z^{-1}}
\end{align}
$$
其中，$W_{N}^{k} = \e^{-\J \tfrac{2\pi}{N}k}$，$H[k] = H(z) \big|_{z = W_{M+1}^{k}}$。因此，可以通过 $M+1$ 个**频率取样**回路**并联**的方式设计 FIR 滤波器。


## 线性相位 FIR 滤波器

### 线性相位滤波器的实现

对**线性相位** LTI 系统，应有
$$
\begin{align} 
H(\e^{\J \omega}) &= \hat{H}(\e^{\J\omega}) \e^{-\J (\alpha\omega - \beta)} \\
&= \hat{H}(\e^{\J\omega}) \cos(\alpha\omega - \beta) - \J \hat{H}(\e^{\J\omega}) \sin(\alpha\omega - \beta) 
\end{align}
$$
其中 $\hat{H}(\e^{\J\omega})$ 为实函数；由频率响应定义，
$$
H(\e^{\J \omega}) = \sum\limits_{n=-\infty}^{\infty} h[n] \e^{-\J \omega n} = \sum\limits_{n=-\infty}^{\infty} h[n] \cos(\omega n) - \J \sum\limits_{n=-\infty}^{\infty} h[n] \sin(\omega n)
$$
两式**相位相同**，应有
$$
-\dfrac{\sin(\alpha\omega - \beta)}{\cos(\alpha\omega - \beta)} = -\dfrac{\sum\limits_{n=-\infty}^{\infty} h[n] \sin(\omega n)}{\sum\limits_{n=-\infty}^{\infty} h[n] \cos(\omega n)}
$$
即得
$$
\sum\limits_{n=-\infty}^{\infty} h[n] \sin(\omega (n - \alpha) + \beta) = 0
$$
为使上式对任意 $\omega$ 成立，
1. 若 **$\beta = 0$ 或 $\beta = \pi$**，则 $h[n]$ 应**关于 $n = \alpha$ 偶对称**；
2. 若 **$\beta = \pm\cfrac{\pi}{2}$**，则 $h[n]$ 应**关于 $n = \alpha$ 奇对称**。

因此，因果的线性相位滤波器**一定是 FIR 滤波器**，且其冲激响应 $h[n]$ 满足以下四种情况之一：

```tx
| 阶数 $M = 2\alpha$ | 对称性 $\beta$ ||
| ^^ | 偶对称 $\beta = 0, \pi$ | 奇对称 $\beta = \pm \pi/2$ |\
|    | $h[n] = h[M - n]$ | $h[n] = -h[M - n]$ |
| :---- | :---- | :---- |
| 偶数 | **[[#第 I 类线性相位 FIR 滤波器]]** | **[[#第 III 类线性相位 FIR 滤波器]]** |\
|      | 低通、高通、带通 | 带通 |
| 奇数 | **[[#第 II 类线性相位 FIR 滤波器]]** | **[[#第 IV 类线性相位 FIR 滤波器]]** |\
|      | 低通、带通 | 高通、带通 |
```

#### 第 I 类线性相位 FIR 滤波器



### 窗函数法设计线性相位 FIR 滤波器

设我们期望实现频响为 $H_{\mathrm{d}}(\e^{\J\omega})$ 的滤波器，为此设计 $h[n]$，使其 DTFT $H(\e^{\J\omega})$ 尽可能接近 $H_{\mathrm{d}}(\e^{\J\omega})$。在**均方误差**意义下，即希望
$$
h[n] = \arg\limits_{h[n]} \min \| H(\e^{\J\omega}) - H_{\mathrm{d}}(\e^{\J\omega}) \|^{2}
= \arg\limits_{h[n]} \min \dfrac{1}{2\pi} \int_{-\pi}^{\pi} | H(\e^{\J\omega}) - H_{\mathrm{d}}(\e^{\J\omega}) |^{2} \dif \omega
$$
设 $h_{\mathrm{d}}[n] = \mathrm{IDTFT}\left\{ H_{\mathrm{d}}(\e^{\J\omega}) \right\}$，由 Parseval 定理，有
$$
\begin{align} 
\| H(\e^{\J\omega}) - H_{\mathrm{d}}(\e^{\J\omega}) \|^{2} &= \sum\limits_{n=-\infty}^{\infty} | h[n] - h_{\mathrm{d}}[n] |^{2}  \\
&= \sum\limits_{n=0}^{M} | h[n] - h_{\mathrm{d}}[n] |^{2} + \underbrace{ \sum\limits_{n = -\infty}^{-1} | h_{\mathrm{d}}[n] |^{2} + \sum\limits_{n = M+1}^{\infty} | h_{\mathrm{d}}[n] |^{2} }_{ \text{与 $h[n]$ 无关} }
\end{align}
$$
因此，**均方误差**意义下的**最优 $M$ 阶 FIR 滤波器**冲激响应为
$$
h[n] = \begin{cases} h_{\mathrm{d}}[n], & 0 \le n \le M, \\ 0, & \text{otherwise}, \end{cases}
= \mathrm{IDTFT}\left\{ H_{\mathrm{d}}(\e^{\J\omega}) \right\} \cdot w_{\text{rect},M}[n]
$$
即 $\mathrm{IDTFT}\left\{ H_{\mathrm{d}}(\e^{\J\omega}) \right\}$ 加**矩形窗**截断得到。

然而，矩形窗截断会引入**Gibbs 现象**，导致频率响应出现较大波纹。为减小 Gibbs 现象，可采用其他窗函数 $w[n]$ 截断理想冲激响应，从而设计 FIR 滤波器。

#### 固定窗



#### Kaiser 窗

Kaiser 窗是一种**参数化**窗函数，可通过调整参数 $\beta$ 控制主瓣宽度与旁瓣高度之间的权衡。Kaiser 窗定义为
$$
w_{\text{Kaiser},M;\beta}[n] = \begin{cases}
\dfrac{I_{0}\left( \beta \sqrt{1 - \left( \cfrac{n}{\alpha} - 1 \right)^{2}} \right)}{I_{0}(\beta)}, & 0 \le n \le M, \\
0, & \text{otherwise},
\end{cases}
$$
其中，$\alpha = \dfrac{M}{2}$，$I_{0}(\cdot)$ 是**零阶修正贝塞尔函数 (modified Bessel function of the first kind of order zero)**，定义为
$$
I_{0}(x) = \sum\limits_{m=0}^{\infty} \dfrac{1}{(m!)^{2}} \left( \dfrac{x}{2} \right)^{2m} = 1 + \sum\limits_{k=1}^{\infty} \left( \dfrac{(x/2)^{k}}{k!} \right)^{2} 
$$

Kaiser 窗的参数由经验公式给出，即对于给定的**阻带波纹** $\delta_{2}$（$\alpha_2 = -20 \log_{10} \delta_{2}$ dB）和**过渡带宽度** $\Delta \omega = |\omega_{\mathrm{s}} - \omega_{\mathrm{p}}|$，有
$$
\begin{align} 
&\beta = \begin{cases}
0.1102 (\alpha_2 - 8.7), & \alpha_2 > 50, &\hspace{-1em}\text{（深阻带）} \\
0.5842 (\alpha_2 - 21)^{0.4} + 0.07886 (\alpha_2 - 21), & 21 \le \alpha_2 \le 50, &\hspace{-1em}\text{（中阻带）} \\
0, & \alpha_2 < 21, &\hspace{-1em}\text{（浅阻带）}
\end{cases} \\
&M = \dfrac{\alpha_2 - 8}{2.285 \Delta \omega} 
\end{align}
$$

